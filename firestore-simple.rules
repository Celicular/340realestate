rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // TEMPORARY: Allow public read access to blogs for testing
    // In production, you should implement proper authentication
    match /blogs/{blogId} {
      allow read: if true; // Anyone can read blogs
      allow write: if request.auth != null; // Only authenticated users can write
    }
    
    // Allow public read for rental properties and booking requests
    match /rentalProperties/{propertyId} {
      allow read: if true;
      allow write: if request.auth != null;
      
      // Booking requests subcollection
      match /bookingRequests/{bookingId} {
        allow read: if true; // Property owners/agents need to read booking requests
        allow write: if true; // Anyone can submit booking requests
      }
    }
    
    match /properties/{propertyId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /saleProperties/{saleId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /soldProperties/{soldId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /reviews/{reviewId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /team_members/{memberId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /users/{userId} {
      allow read, write: if request.auth != null;
    }
    
    match /contacts/{contactId} {
      allow read, write: if true; // Allow contact form submissions
    }
    
    match /rentals/{rentalId} {
      allow read, write: if request.auth != null;
    }
    
    // Agents collection - public read, authenticated write
    match /agents/{agentId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // Portfolio collections - public read, authenticated write
    match /residentialPortfolio/{itemId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /commercialPortfolio/{itemId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    match /landPortfolio/{itemId} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // Villa bookings collection
    match /villaBookings/{bookingId} {
      allow read: if true; // Agents need to read booking requests
      allow write: if true; // Anyone can submit booking requests
    }
  }
}